syntax = "proto3";

package authservice;

import "auth_models.proto";

option go_package = "grpc_service/internal/proto/auck.authservice1.v1;authservicev1";

message PermissionCreateRequest {
    Permission permission = 1;
}

message PermissionCreateResponse {
    string id = 1;
}


message PermissionReadRequest {
    string id = 1;
}

message PermissionReadResponse{
    Permission permission = 1;
}

message PermissionUpdateRequest {
    string id = 1;
    Permission permission = 2;
}

message PermissionUpdateResponse {    
    string id = 1;
}

message PermissionDeleteRequest {
    string id = 1;
}

message PermissionDeleteResponse {
  bool success = 1;
}

message PermissionListRequest {
    int32 page_size = 1;
    string page_token = 2;
    string filter = 3;  // e.g. "is_active = true"
    string order_by = 4; 
}

message PermissionListResponse {
    repeated Permission items = 1;
    string next_page_token = 2;
}

message UserGrantPermissionRequest {
  string uuid = 1;
  string permission_id = 2;
}
message UserGrantPermissionResponse {
  bool success = 1;
}
message UserRevokePermissionRequest {
  string uuid = 1;
  string permission_id = 2;
}
message UserRevokePermissionResponse {
  bool success = 1;
}

message UserPermissionsGetRequest {
  string uuid = 1;
    int32 page_size = 2;
    string page_token = 3;
    string filter = 4;  // e.g. "is_active = true"
    string order_by = 5; 
}
message UserPermissionsGetResponse {
  repeated Permission permissions = 1;
  // Cписок прямо отозванных прав,
  // чтобы клиент понимал, какие были «вычеркнуты»
  repeated string revoked_permission_ids = 2;
}

message CheckAccessRequest {
  string uuid = 1;
  string permission_name  = 2;
}

message CheckAccessResponse {
  bool allowed = 1;
  // (Опционально) причина отказа или мета‑информация
  // string reason  = 2;
}

message CheckServiceAccessRequest {
  string uuid = 1;
  string service_name  = 2;
  string method_name  = 3;
}

message CheckServiceAccessResponse {
  bool allowed = 1;
}
